{"ast":null,"code":"import _regeneratorRuntime from\"/Users/vaibhav/Desktop/Office/E-commerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/vaibhav/Desktop/Office/E-commerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/vaibhav/Desktop/Office/E-commerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Button from\"../components/button\";import Logo from\"../assets/images/logo2.png\";import login from\"../assets/images/login.png\";// import Timer from \"../components/timer\";\nimport*as API from\"../helpers/api\";import{Link}from\"react-router-dom\";import OtpInput from\"react-otp-input\";import{ArrowDownward}from\"@material-ui/icons\";import{useLocation,useHistory}from\"react-router\";//REDUX\nimport{useDispatch,useSelector}from\"react-redux\";// const initialState = {\n//   initialSeconds: 10,\n//   initialMinute: 0,\n// };\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Verification(){var history=useHistory();var state=useSelector(function(state){return state.AuthProvider;});var counter=useSelector(function(state){return state;});var location=useLocation();var dispatch=useDispatch();// const [minutes, setMinutes] = useState(0);\n// const [seconds, setSeconds] = useState(10);\n// const [resendOTP, setResendOTP] = useState(false);\n//USEEFFECTS\n// useEffect(() => {\n//   let myInterval = setInterval(() => {\n//     if (seconds > 0) {\n//       setSeconds(seconds - 1);\n//     }\n//     if (seconds === 0) {\n//       if (minutes === 0) {\n//         clearInterval(myInterval);\n//       } else {\n//         setMinutes(minutes - 1);\n//         setSeconds(59);\n//       }\n//     }\n//   }, 1000);\n//   return () => {\n//     clearInterval(myInterval);\n//   };\n// });\n// if (minutes === 0 && seconds === 0) {\n//   setResendOTP(true);\n// }\n//OTP\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),otp=_useState2[0],setOtp=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),serverError=_useState4[0],setServerError=_useState4[1];//HANDLE_CHANGE\nvar handleChange=function handleChange(e){setOtp(e);};//LOADER\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];// const [second, setSecond] = useState(10);\n//ERROR-MSGS\nvar _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),OTPError=_useState8[0],setOTPError=_useState8[1];//HANDLE VERIFY\nvar handleVerify=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var flag,requestObj,response,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);setOTPError(\"\");flag=validateInput();if(flag){_context.next=6;break;}setLoading(false);return _context.abrupt(\"return\");case 6:_context.prev=6;requestObj={emailId:location.state.email,verificationCode:otp};if(!state.isAuthenticated){_context.next=16;break;}_context.next=11;return API.customer_email_verification(requestObj);case 11:response=_context.sent;if(response.status===200){setLoading(false);dispatch({type:\"LOGIN\",payload:{isAuthenticated:true,user:response.data.data,token:response.data.token}});history.push({pathname:\"/welcome\"});}if(response.status===409){setLoading(false);setServerError(\"Incorrect verification code.\");}_context.next=21;break;case 16:_context.next=18;return API.check_password_verified_code(requestObj);case 18:_response=_context.sent;if(_response.status===200){setLoading(false);history.push({pathname:\"/confirm-password\",state:{email:location.state.email}});}if(_response.status===409){setLoading(false);setServerError(\"Incorrect verification code.\");}case 21:_context.next=26;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](6);setLoading(false);case 26:case\"end\":return _context.stop();}}},_callee,null,[[6,23]]);}));return function handleVerify(){return _ref.apply(this,arguments);};}();//HANDLE RESEND OTP\nvar handleResend=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var flag,requestObj,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:flag=validateInput();if(flag){_context2.next=4;break;}setLoading(false);return _context2.abrupt(\"return\");case 4:_context2.prev=4;requestObj={emailId:location.state.email};if(!(counter.counter===false)){_context2.next=11;break;}_context2.next=9;return API.resend_verification_code(requestObj);case 9:response=_context2.sent;if(response.status===200){dispatch({type:\"COUNTER_RESET\"});}case 11:_context2.next=15;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](4);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[4,13]]);}));return function handleResend(){return _ref2.apply(this,arguments);};}();//INPUT VALIDATION\nvar validateInput=function validateInput(){var flag=true;if(otp){if(otp.length===4){setOTPError({field:\"\",message:\"\"});flag=true;}else{flag=false;setOTPError({field:\"OTP\",message:\"That doesn't look like an OTP.\"});}}else{flag=false;setOTPError({field:\"OTP\",message:\"You missed a bit! Don't forget to add OTP.\"});}return flag;};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen flex flex-col justify-center sm:py-12 bg-cover bg-center bg-no-repeat\",style:{backgroundImage:\"url(\".concat(login,\")\")},children:[/*#__PURE__*/_jsx(\"div\",{className:\" absolute text-7xl font-bold capitalize text-white top-24 w-2/5 left-24\",children:\"Verify your account to Get access to everything\"}),/*#__PURE__*/_jsx(\"div\",{className:\" mr-24 xs:p-0 ml-auto md:w-full md:max-w-md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-12 shadow-lg w-full rounded-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-5\",children:/*#__PURE__*/_jsx(\"img\",{src:Logo,alt:\"logo\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"font-bold text-center text-2xl mb-5\",children:\"Enter verification code\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"We have just sent you a verification code to\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:location.state.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-5 py-7\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-7\",children:[/*#__PURE__*/_jsx(OtpInput// value={this.state.otp}\n,{value:otp,onChange:handleChange,numInputs:4,separator:/*#__PURE__*/_jsx(\"span\",{children:\"-\"}),className:\" text-black mx-auto\",inputStyle:\"border \".concat(OTPError.field===\"OTP\"?\"border-red-300\":\"border-hippie-blue-500\",\"  text-5xl mx-2 focus:outline-none\"),containerStyle:\" text-center\"}),OTPError.field===\"OTP\"&&/*#__PURE__*/_jsx(\"p\",{className:\"my-1 text-center text-xs text-left text-red-500\",children:OTPError.message})]}),/*#__PURE__*/_jsxs(Button,{size:\"big\",className:\"w-full relative\",variant:\"primary\",id:\"loginBtn\",onClick:handleVerify,loading:loading,children:[\"Verify\",/*#__PURE__*/_jsx(\"div\",{className:\"transform -rotate-90 ml-2 loginArrow \",children:/*#__PURE__*/_jsx(ArrowDownward,{className:\"animate-bounce\",fontSize:\"small\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-red-500 text-sm text-center\",children:serverError})]}),/*#__PURE__*/_jsx(\"div\",{className:\"py-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center sm:text-left whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"transition duration-200 mx-5 px-5 py-4 cursor-pointer font-normal text-sm rounded-lg text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-200 focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 ring-inset\",onClick:handleResend,children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",className:\"w-4 h-4 inline-block align-text-top\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"inline-block ml-1\",children:[\"Send the code again in\",\" \"]})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"py-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-1\",children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center sm:text-left whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"transition duration-200 mx-5 px-5 py-4 cursor-pointer font-normal text-sm rounded-lg text-gray-500 hover:bg-gray-200 focus:outline-none focus:bg-gray-300 focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 ring-inset\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",className:\"w-4 h-4 inline-block align-text-top\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M10 19l-7-7m0 0l7-7m-7 7h18\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block ml-1\",children:\"Back to Home\"})]})})})})})]})})]});}","map":{"version":3,"sources":["/Users/vaibhav/Desktop/Office/E-commerce/src/pages/verification.js"],"names":["React","useState","Button","Logo","login","API","Link","OtpInput","ArrowDownward","useLocation","useHistory","useDispatch","useSelector","Verification","history","state","AuthProvider","counter","location","dispatch","otp","setOtp","serverError","setServerError","handleChange","e","loading","setLoading","OTPError","setOTPError","handleVerify","flag","validateInput","requestObj","emailId","email","verificationCode","isAuthenticated","customer_email_verification","response","status","type","payload","user","data","token","push","pathname","check_password_verified_code","handleResend","resend_verification_code","length","field","message","backgroundImage"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Button from \"../components/button\";\nimport Logo from \"../assets/images/logo2.png\";\nimport login from \"../assets/images/login.png\";\n\n// import Timer from \"../components/timer\";\nimport * as API from \"../helpers/api\";\nimport { Link } from \"react-router-dom\";\nimport OtpInput from \"react-otp-input\";\nimport { ArrowDownward } from \"@material-ui/icons\";\nimport { useLocation, useHistory } from \"react-router\";\n\n//REDUX\nimport { useDispatch, useSelector } from \"react-redux\";\n\n// const initialState = {\n//   initialSeconds: 10,\n//   initialMinute: 0,\n// };\n\nexport default function Verification() {\n  const history = useHistory();\n  const state = useSelector((state) => state.AuthProvider);\n  const counter = useSelector((state) => state);\n  const location = useLocation();\n  const dispatch = useDispatch();\n\n  // const [minutes, setMinutes] = useState(0);\n  // const [seconds, setSeconds] = useState(10);\n  // const [resendOTP, setResendOTP] = useState(false);\n\n  //USEEFFECTS\n  // useEffect(() => {\n  //   let myInterval = setInterval(() => {\n  //     if (seconds > 0) {\n  //       setSeconds(seconds - 1);\n  //     }\n  //     if (seconds === 0) {\n  //       if (minutes === 0) {\n  //         clearInterval(myInterval);\n  //       } else {\n  //         setMinutes(minutes - 1);\n  //         setSeconds(59);\n  //       }\n  //     }\n  //   }, 1000);\n  //   return () => {\n  //     clearInterval(myInterval);\n  //   };\n  // });\n\n  // if (minutes === 0 && seconds === 0) {\n  //   setResendOTP(true);\n  // }\n\n  //OTP\n  const [otp, setOtp] = useState(\"\");\n  const [serverError, setServerError] = useState(\"\");\n\n  //HANDLE_CHANGE\n  const handleChange = (e) => {\n    setOtp(e);\n  };\n\n  //LOADER\n  const [loading, setLoading] = useState(false);\n  // const [second, setSecond] = useState(10);\n\n  //ERROR-MSGS\n  const [OTPError, setOTPError] = useState(\"\");\n\n  //HANDLE VERIFY\n  const handleVerify = async () => {\n    setLoading(true);\n    setOTPError(\"\");\n    const flag = validateInput();\n    if (!flag) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const requestObj = {\n        emailId: location.state.email,\n        verificationCode: otp,\n      };\n\n      if (state.isAuthenticated) {\n        const response = await API.customer_email_verification(requestObj);\n        if (response.status === 200) {\n          setLoading(false);\n          dispatch({\n            type: \"LOGIN\",\n            payload: {\n              isAuthenticated: true,\n              user: response.data.data,\n              token: response.data.token,\n            },\n          });\n          history.push({ pathname: \"/welcome\" });\n        }\n        if (response.status === 409) {\n          setLoading(false);\n          setServerError(\"Incorrect verification code.\");\n        }\n      } else {\n        //this block will run when \"isAuthenticated\" is false\n        const response = await API.check_password_verified_code(requestObj);\n        if (response.status === 200) {\n          setLoading(false);\n          history.push({\n            pathname: \"/confirm-password\",\n            state: { email: location.state.email },\n          });\n        }\n        if (response.status === 409) {\n          setLoading(false);\n          setServerError(\"Incorrect verification code.\");\n        }\n      }\n    } catch (e) {\n      setLoading(false);\n    }\n  };\n\n  //HANDLE RESEND OTP\n  const handleResend = async () => {\n    let flag = validateInput();\n    if (!flag) {\n      setLoading(false);\n      return;\n    }\n    try {\n      const requestObj = {\n        emailId: location.state.email,\n      };\n      if (counter.counter === false) {\n        const response = await API.resend_verification_code(requestObj);\n        if (response.status === 200) {\n          dispatch({\n            type: \"COUNTER_RESET\",\n          });\n        }\n      }\n    } catch (e) {}\n  };\n\n  //INPUT VALIDATION\n  const validateInput = () => {\n    let flag = true;\n    if (otp) {\n      if (otp.length === 4) {\n        setOTPError({\n          field: \"\",\n          message: \"\",\n        });\n        flag = true;\n      } else {\n        flag = false;\n        setOTPError({\n          field: \"OTP\",\n          message: \"That doesn't look like an OTP.\",\n        });\n      }\n    } else {\n      flag = false;\n      setOTPError({\n        field: \"OTP\",\n        message: \"You missed a bit! Don't forget to add OTP.\",\n      });\n    }\n    return flag;\n  };\n\n  return (\n    <div\n      className=\"min-h-screen flex flex-col justify-center sm:py-12 bg-cover bg-center bg-no-repeat\"\n      style={{ backgroundImage: `url(${login})` }}\n    >\n      <div className=\" absolute text-7xl font-bold capitalize text-white top-24 w-2/5 left-24\">\n        Verify your account to Get access to everything\n      </div>\n      <div className=\" mr-24 xs:p-0 ml-auto md:w-full md:max-w-md\">\n        <div className=\"bg-white p-12 shadow-lg w-full rounded-2xl\">\n          <div className=\"flex justify-center py-5\">\n            <img src={Logo} alt=\"logo\" />\n          </div>\n\n          <h1 className=\"font-bold text-center text-2xl mb-5\">\n            Enter verification code\n          </h1>\n          <div>\n            We have just sent you a verification code to{\" \"}\n            <span className=\"font-semibold\">{location.state.email}</span>\n          </div>\n          <div className=\"px-5 py-7\">\n            <div className=\"mb-7\">\n              <OtpInput\n                // value={this.state.otp}\n                value={otp}\n                onChange={handleChange}\n                numInputs={4}\n                separator={<span>-</span>}\n                className=\" text-black mx-auto\"\n                inputStyle={`border ${\n                  OTPError.field === \"OTP\"\n                    ? \"border-red-300\"\n                    : \"border-hippie-blue-500\"\n                }  text-5xl mx-2 focus:outline-none`}\n                containerStyle=\" text-center\"\n              />\n              {OTPError.field === \"OTP\" && (\n                <p className=\"my-1 text-center text-xs text-left text-red-500\">\n                  {OTPError.message}\n                </p>\n              )}\n            </div>\n\n            <Button\n              size={\"big\"}\n              className=\"w-full relative\"\n              variant={\"primary\"}\n              id=\"loginBtn\"\n              onClick={handleVerify}\n              loading={loading}\n            >\n              Verify\n              <div className=\"transform -rotate-90 ml-2 loginArrow \">\n                <ArrowDownward className=\"animate-bounce\" fontSize={\"small\"} />\n              </div>\n            </Button>\n            <div className=\"mt-2 text-red-500 text-sm text-center\">\n              {serverError}\n            </div>\n          </div>\n          <div className=\"py-2\">\n            <div className=\"grid grid-cols-2 gap-1\">\n              <div className=\"text-center sm:text-left whitespace-nowrap\">\n                <button\n                  className=\"transition duration-200 mx-5 px-5 py-4 cursor-pointer font-normal text-sm rounded-lg text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-200 focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 ring-inset\"\n                  onClick={handleResend}\n                >\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    fill=\"none\"\n                    viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\"\n                    className=\"w-4 h-4 inline-block align-text-top\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth=\"2\"\n                      d=\"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z\"\n                    />\n                  </svg>\n                  <span className=\"inline-block ml-1\">\n                    Send the code again in{\" \"}\n                    {/* <span>\n                    \n\n                      <span className=\"text-sm text-gray-500\">\n                        {minutes}:{seconds < 10 ? `0${seconds}` : seconds}\n                      </span>\n                    </span> */}\n                  </span>\n                </button>\n              </div>\n              {/* <div className=\"text-center sm:text-right  whitespace-nowrap\">\n                <Link to=\"/register\">\n                  <button className=\"transition duration-200 mx-5 px-5 py-4 cursor-pointer font-normal text-sm rounded-lg text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-200 focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 ring-inset\">\n                    <CreateOutlined style={{ fontSize: \"15px\" }} />\n                    <span className=\"inline-block ml-1\">Register</span>\n                  </button>\n                </Link>\n              </div> */}\n            </div>\n          </div>\n          <div className=\"py-2\">\n            <div className=\"grid grid-cols-2 gap-1\">\n              <Link to=\"/\">\n                <div className=\"text-center sm:text-left whitespace-nowrap\">\n                  <button className=\"transition duration-200 mx-5 px-5 py-4 cursor-pointer font-normal text-sm rounded-lg text-gray-500 hover:bg-gray-200 focus:outline-none focus:bg-gray-300 focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 ring-inset\">\n                    <svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      fill=\"none\"\n                      viewBox=\"0 0 24 24\"\n                      stroke=\"currentColor\"\n                      className=\"w-4 h-4 inline-block align-text-top\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth=\"2\"\n                        d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"\n                      />\n                    </svg>\n                    <span className=\"inline-block ml-1\">Back to Home</span>\n                  </button>\n                </div>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}